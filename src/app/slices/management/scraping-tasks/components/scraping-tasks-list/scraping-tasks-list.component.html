<p-card header="Scraping Tasks">
  <ng-container *ngIf="!loading || tasks.length > 0; else loadingTpl">
    <div
      class="task-list"
      style="max-height: 245px; overflow-y: auto;"
      pInfiniteScroll
      [infiniteScrollDistance]="1"
      [infiniteScrollThrottle]="150"
      (onLazyLoad)="loadMore()"
    >
      <ul style="list-style-type: none; padding-left: 0; margin: 0;">
        <li *ngFor="let task of tasks" class="task-item" style="padding: 0.5rem 0; border-bottom: 1px solid #eee;">
          <strong>
            <i class="pi pi-globe" style="margin-right: 0.3rem; color: var(--primary-color)"></i>
            Domain:
          </strong> {{ task.domain?.name || 'N/A' }}
          <br />

          <strong>
            <i class="pi pi-user" style="margin-right: 0.3rem; color: var(--text-secondary-color)"></i>
            Executor:
          </strong> {{ task.scrapingExecutor?.scraperName || 'Unassigned' }}
          <br />

          <strong>
            <i class="pi pi-calendar" style="margin-right: 0.3rem; color: var(--text-secondary-color)"></i>
            Published:
          </strong> {{ task.publishedAt | date: 'short' }}
          <br />

          <strong>
            <i class="pi pi-info-circle" style="margin-right: 0.3rem; color: var(--text-secondary-color)"></i>
            Status:
          </strong>
          <span [ngClass]="task.completedAt ? 'text-success' : 'text-warning'">
            {{ task.completedAt ? 'Completed' : 'Pending' }}
          </span>
          <br />

          <a
            [routerLink]="['/management/scraping-tasks', task.id]"
            class="p-link"
            title="View Details"
            aria-label="View Details"
            style="padding: 0; margin-top: 0.3rem; display: inline-block;"
          >
            <i class="pi pi-eye"></i>
          </a>
        </li>
      </ul>

      <p *ngIf="loadingMore" class="text-center" style="margin-top: 1rem;">Loading more...</p>
    </div>

    <ng-template #noTasks>
      <p>No tasks found.</p>
    </ng-template>
  </ng-container>

  <ng-template #loadingTpl>
    <p>Loading tasks...</p>
  </ng-template>
</p-card>
